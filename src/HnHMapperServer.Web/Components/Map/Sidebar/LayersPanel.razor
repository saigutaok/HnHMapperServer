@using HnHMapperServer.Web.Models
@using MudBlazor

<!-- Layers panel with visibility toggles -->
<MudText Typo="Typo.h6" Class="mb-3">Layer Visibility</MudText>

<div class="layers-container">
    <MudStack Spacing="3">
    <!-- Players Layer -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="layer-row layer-row-primary">
        <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center">
            <MudIcon Icon="@Icons.Material.Filled.Person" Size="Size.Medium" Class="layer-icon" />
            <MudText Typo="Typo.body1">Players</MudText>
        </MudStack>
        <MudSwitch Value="@State.ShowPlayers"
                   ValueChanged="@((bool value) => OnTogglePlayers.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   ThumbIcon="@(State.ShowPlayers ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowPlayers ? Color.Success : Color.Default)" />
    </MudStack>

    <!-- Player Names (sub-toggle) -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween"
              Class="@(State.ShowPlayers ? "layer-row layer-row-sub" : "layer-row layer-row-sub layer-row-disabled")">
        <MudText Typo="Typo.body2">Player Names</MudText>
        <MudSwitch Value="@State.ShowPlayerTooltips"
                   ValueChanged="@((bool value) => OnTogglePlayerTooltips.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   Disabled="@(!State.ShowPlayers)"
                   ThumbIcon="@(State.ShowPlayerTooltips ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowPlayerTooltips ? Color.Success : Color.Default)" />
    </MudStack>

    <MudDivider />

    <!-- Markers Layer -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="layer-row layer-row-primary">
        <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center">
            <MudIcon Icon="@Icons.Material.Filled.Place" Size="Size.Medium" Class="layer-icon" />
            <MudText Typo="Typo.body1">Markers</MudText>
        </MudStack>
        <MudSwitch Value="@State.ShowMarkers"
                   ValueChanged="@((bool value) => OnToggleMarkers.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   ThumbIcon="@(State.ShowMarkers ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowMarkers ? Color.Success : Color.Default)" />
    </MudStack>

    <MudDivider />

    <!-- Custom Markers Layer -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="layer-row layer-row-primary">
        <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center">
            <MudIcon Icon="@Icons.Material.Filled.AddLocation" Size="Size.Medium" Color="Color.Success" Class="layer-icon" />
            <MudText Typo="Typo.body1">Custom Markers</MudText>
        </MudStack>
        <MudSwitch Value="@State.ShowCustomMarkers"
                   ValueChanged="@((bool value) => OnToggleCustomMarkers.InvokeAsync(value))"
                   Color="Color.Success"
                   Class="layer-switch"
                   ThumbIcon="@(State.ShowCustomMarkers ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowCustomMarkers ? Color.Success : Color.Default)" />
    </MudStack>

    <MudDivider />

    <!-- Thingwalls Layer -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="layer-row layer-row-primary">
        <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center">
            <MudIcon Icon="@Icons.Material.Filled.Info" Size="Size.Medium" Class="layer-icon" />
            <MudText Typo="Typo.body1">Thingwalls</MudText>
        </MudStack>
        <MudSwitch Value="@State.ShowThingwalls"
                   ValueChanged="@((bool value) => OnToggleThingwalls.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   ThumbIcon="@(State.ShowThingwalls ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowThingwalls ? Color.Success : Color.Default)" />
    </MudStack>

    <!-- Thingwall Tooltips (sub-toggle) -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween"
              Class="@(State.ShowThingwalls ? "layer-row layer-row-sub" : "layer-row layer-row-sub layer-row-disabled")">
        <MudText Typo="Typo.body2">Thingwall Tooltips</MudText>
        <MudSwitch Value="@State.ShowThingwallTooltips"
                   ValueChanged="@((bool value) => OnToggleThingwallTooltips.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   Disabled="@(!State.ShowThingwalls)"
                   ThumbIcon="@(State.ShowThingwallTooltips ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowThingwallTooltips ? Color.Success : Color.Default)" />
    </MudStack>

    <MudDivider />

    <!-- Quest Givers Layer -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="layer-row layer-row-primary">
        <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center">
            <MudIcon Icon="@Icons.Material.Filled.Star" Size="Size.Medium" Class="layer-icon" />
            <MudText Typo="Typo.body1">Quest Givers</MudText>
        </MudStack>
        <MudSwitch Value="@State.ShowQuests"
                   ValueChanged="@((bool value) => OnToggleQuests.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   ThumbIcon="@(State.ShowQuests ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowQuests ? Color.Success : Color.Default)" />
    </MudStack>

    <!-- Quest Tooltips (sub-toggle) -->
    <MudStack Row="true" Spacing="2" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween"
              Class="@(State.ShowQuests ? "layer-row layer-row-sub" : "layer-row layer-row-sub layer-row-disabled")">
        <MudText Typo="Typo.body2">Quest Tooltips</MudText>
        <MudSwitch Value="@State.ShowQuestTooltips"
                   ValueChanged="@((bool value) => OnToggleQuestTooltips.InvokeAsync(value))"
                   Color="Color.Primary"
                   Class="layer-switch"
                   Disabled="@(!State.ShowQuests)"
                   ThumbIcon="@(State.ShowQuestTooltips ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                   ThumbIconColor="@(State.ShowQuestTooltips ? Color.Success : Color.Default)" />
    </MudStack>

    </MudStack>
</div>

@code {
    /// <summary>
    /// Current map state with layer visibility flags
    /// </summary>
    [Parameter] public MapState State { get; set; } = new();

    /// <summary>
    /// Event callback when player layer visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnTogglePlayers { get; set; }

    /// <summary>
    /// Event callback when player tooltips visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnTogglePlayerTooltips { get; set; }

    /// <summary>
    /// Event callback when markers layer visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleMarkers { get; set; }

    /// <summary>
    /// Event callback when custom markers layer visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleCustomMarkers { get; set; }

    /// <summary>
    /// Event callback when thingwalls layer visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleThingwalls { get; set; }

    /// <summary>
    /// Event callback when thingwall tooltips visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleThingwallTooltips { get; set; }

    /// <summary>
    /// Event callback when quest givers layer visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleQuests { get; set; }

    /// <summary>
    /// Event callback when quest tooltips visibility changes
    /// </summary>
    [Parameter] public EventCallback<bool> OnToggleQuestTooltips { get; set; }
}
